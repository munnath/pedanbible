<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PedanBible</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        input, button { padding: 5px; margin: 5px; font-size: 18px; }
        #message { font-size: 20px; margin-top: 20px; }
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            max-width: 800px;
            margin: auto;
        }
        .category-container {
            width: 100%;
            margin-bottom: 10px;
        }
        .category-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .progress-container {
            display: flex;
            justify-content: center; /* üîπ Centre les carr√©s */
            align-items: center;
            gap: 5px;
            margin-top: 20px;
        }
        .livre {

            font-size: 25px;
            padding: 1px;
            padding-left: 30px; /* D√©cale le texte vers la droite */
            margin: 1px;
            border-radius: 10px;
            color: black;
            font-weight: bold;
            border: none;
            cursor: pointer;
            width: 10px;
            height: 100px;
            transition: transform 0.2s;

            writing-mode: vertical-rl; /* Texte √©crit verticalement de droite √† gauche */

            text-align: center;
        }
        .livre:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body>

    <h1>PedanBible</h1>

    <h1>üìñ Jeu des Livres de la Bible</h1>

    <div id="bibleBooks"></div>

    <p>Essayez de deviner les mots du texte biblique du jour. √Ä vous de retrouver le livre dont il provient !</p>

    <input type="text" id="wordInput" placeholder="Tapez un mot...">
    <button onclick="checkWord()">Valider</button>
    <button id="hintButton" onclick="revealHint()">Indice</button>
    <div id="progress" class="progress-container"></div>

    <p id="message"></p>

<p id="maskedText">
    
</p>

<style>
    .hidden-word {
        font-size: 18px;
        margin: 2px;
        padding: 5px;
        display: inline-block;
        background: black;
        color: black;  /* Texte cach√© */
        border-radius: 5px;
    }
    .revealed {
        font-size: 18px;
        background: white;
        color: black;  /* Texte r√©v√©l√© */
        padding: 2px 4px;
        border-radius: 4px;
        transition: background 0.3s ease-in-out;
    }

    .almost {
        color: rgb(255, 102, 0);
        background: black;
        margin: 2px;
        padding: 5px;
        border-radius: 4px;
        font-style: italic;
    }

    .punctuation {
        font-size: 18px;
        /*white-space: pre;*/ /* Pr√©serve l'espace */
        /*display: inline-block;*/
        color: black; /* üîπ La ponctuation est visible */
    }

    .square {
        width: 20px;
        height: 20px;
        border-radius: 5px;
    }

    .green { background-color: rgb(19, 255, 19); }
    .red { background-color: rgb(255, 22, 22); }

    .similar {
        font-size: 18px;
        background: gray;
        color: orange;
    }

    .no-space {
        margin: 0;
    }

    .space-after {
        margin-right: 0.15em;
    }

    .space-before-after {
        margin-left: 0.15em;
        margin-right: 0.15em;
    }

    .newly-found {
        font-size: 18px;
        color: black; /* üîπ Texte en noir */
        font-weight: bold;
        background: #35da35; /* üîπ Vert clair (LightGreen) */
        padding: 2px 4px;
        border-radius: 4px; /* üîπ Coins arrondis pour un meilleur rendu */
        transition: background 0.3s ease-in-out; /* üîπ Animation douce */
    }

    .correct {
        background: green !important;
        color: white !important;
    }

    .wrong {
        background: black !important;
        color: red !important;
    }

    .all-books-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }
</style>
</p>
</div>

<div id="solution" style="display: none;">
    <p>
        
    </p>
</div>



<button id="showSolution">Afficher la solution</button>
<h2 id="chapterTitle" style="display: none;">
    Le chapitre choisi √©tait : Job 17 !
</h2>

<script>
    function checkWord() {
    let inputField = document.getElementById("wordInput");
    let guessedWord = inputField.value.trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    inputField.value = ""; // üîπ Vide le champ apr√®s soumission

    if (!guessedWord) return;

    let almostWords = [];
    let foundCount = 0; // üîπ Compteur du nombre total d'occurrences exactes

    // üîπ Remet tous les mots en "hidden-word" avant de tester un nouveau mot
    let words = document.querySelectorAll(".newly-found, .almost");
    words.forEach(span => {
        span.classList.remove("newly-found", "almost");
        span.classList.add("revealed"); // ‚úÖ Retour en mode cach√©
    });

    // üîπ S√©lectionne tous les mots √† tester
    words = document.querySelectorAll(".hidden-word, .revealed, .newly-found, .almost");

    words.forEach(span => {
        let actualWord = span.dataset.word.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");

        if (actualWord === guessedWord) {
            // ‚úÖ Mot trouv√© -> passe en vert
            span.textContent = span.dataset.word;
            span.classList.remove("hidden-word");
            span.classList.add("newly-found");
            foundCount++; // üî• Compte chaque occurrence trouv√©e
        } else {
            // ‚úÖ V√©rifie la similarit√© et passe en "almost" si proche
            let similarity = computeSimilarity(guessedWord, actualWord);
            if (similarity >= 0.5 && similarity < 0.8) {
                span.textContent = span.dataset.word;
                span.classList.remove("hidden-word");
                span.classList.add("almost"); // Fond noir, texte orange
                almostWords.push(guessedWord);
            } else {
                if (similarity >= 0.8) {
                span.textContent = span.dataset.word;
                span.classList.remove("hidden-word");
                span.classList.add("newly-found"); // Fond noir, texte orange
                almostWords.push(guessedWord);
                foundCount++; // üî• Compte chaque occurrence trouv√©e
            }

            }
        }
    });

    console.log("Nombre de bons mots :", foundCount); // Debugging

    // üîπ Met √† jour les couleurs (mots trouv√©s et similaires)
    highlightAlmostWords(almostWords);

    
    // Mets √† jours les carr√©s verts et rouges
    updateProgress(foundCount);
}

// Fonction pour calculer la similarit√© entre deux mots
function computeSimilarity(word1, word2) {
    let commonLetters = 0;
    let minLength = Math.min(word1.length, word2.length);

    for (let i = 0; i < minLength; i++) {
        if (word1[i] === word2[i]) {
            commonLetters++;
        }
    }

    return commonLetters / Math.max(word1.length, word2.length);
}

// üîπ Fonction pour g√©rer les mots "presque trouv√©s"
function highlightAlmostWords(almostWords) {
    let words = document.querySelectorAll(".hidden-word, .newly-found, .almost");
    
    words.forEach(span => {
        if (!almostWords.includes(span.dataset.word.toLowerCase())) {
            span.classList.remove("almost"); // üîπ R√©tablit les anciens mots en noir
        }
    });
}

    function revealHint() {
        let hiddenWords = Array.from(document.querySelectorAll(".hidden-word"))
            .filter(span => !span.classList.contains("revealed"));

        if (hiddenWords.length > 0) {
            let randomWord = hiddenWords[Math.floor(Math.random() * hiddenWords.length)].dataset.word;

            hiddenWords.forEach(span => {
                if (span.dataset.word === randomWord) {
                    span.textContent = span.dataset.word;
                    span.classList.remove("hidden-word");
                    span.classList.add("newly-found");
                }
            });
        }

        if (document.querySelectorAll(".hidden-word").length === 0) {
            document.getElementById("hintButton").style.display = "none";
        }
    }

    function revealAll() {
        document.querySelectorAll(".hidden-word, .newly-found, .almost").forEach(span => {
            span.textContent = span.dataset.word;
            span.classList.remove("hidden-word", "newly-found", "almost");
            span.classList.add("revealed");
        });
    }


    // üîπ Ajoute la fonction checkWord au champ de saisie sur "Enter"
    document.getElementById("wordInput").addEventListener("keydown", function(event) {
        if (event.key === "Enter") {
            checkWord();
        }
    });
</script>

<script>
        function updateProgress(foundCount) {
            let progressContainer = document.getElementById("progress");
            progressContainer.innerHTML = ""; // üîπ R√©initialise les carr√©s

            if (foundCount === 0) {
                // üî¥ Affiche un carr√© rouge si aucun mot trouv√©
                let redSquare = document.createElement("div");
                redSquare.classList.add("square", "red");
                progressContainer.appendChild(redSquare);
            } else {
                // üü¢ Affiche autant de carr√©s verts que `foundCount`
                for (let i = 0; i < foundCount; i++) {
                    let greenSquare = document.createElement("div");
                    greenSquare.classList.add("square", "green");
                    progressContainer.appendChild(greenSquare);
                }
            }
        }
</script>


<script>
    document.getElementById("showSolution").addEventListener("click", function() {
        document.getElementById("solution").style.display = "block"; // Affiche la solution
        document.getElementById("maskedText").style.display = "none"; // Cache les mots cach√©s
        document.getElementById("chapterTitle").style.display = "block"; // üîπ Affiche le titre du chapitre
    });
</script>


<script>
        function hsvToRgb(h, s, v) {
            let r, g, b;
            let i = Math.floor(h * 6);
            let f = h * 6 - i;
            let p = v * (1 - s);
            let q = v * (1 - f * s);
            let t = v * (1 - (1 - f) * s);
            switch (i % 6) {
                case 0: r = v, g = t, b = p; break;
                case 1: r = q, g = v, b = p; break;
                case 2: r = p, g = v, b = t; break;
                case 3: r = p, g = q, b = v; break;
                case 4: r = t, g = p, b = v; break;
                case 5: r = v, g = p, b = q; break;
            }
            return `rgb(${Math.round(r * 255)}, ${Math.round(g * 255)}, ${Math.round(b * 255)})`;
        }

        const categories = [
            { name: "Pentateuque", key: "pentateuque" },
            { name: "Historiques", key: "historiques" },
            { name: "Sagesse", key: "sagesse" },
            { name: "Grands Proph√®tes", key: "grands-prophetes" },
            { name: "Petits Proph√®tes", key: "petits-prophetes" },
            { name: "√âvangiles", key: "evangiles" },
            { name: "Histoire de l'√âglise", key: "histoire-eglise" },
            { name: "√âp√Ætres de Paul", key: "epitres-paul" },
            { name: "√âp√Ætres G√©n√©rales", key: "epitres-generales" },
            { name: "Proph√©tie", key: "proph√©tie" }
        ];

        // üîπ G√©n√©rer les couleurs pastels avec HSV (s = 0.7, v = 1)
        categories.forEach((category, index) => {
            let hue = index / categories.length; // De 0 √† 1 lin√©airement
            category.color = hsvToRgb(hue, 0.7, 1);
        });

const booksMapping = {
    "Gn": "Gen√®se",
    "Ex": "Exode",
    "Lv": "L√©vitique",
    "Nb": "Nombres",
    "Dt": "Deut√©ronome",
    "Jos": "Josu√©",
    "Jg": "Juges",
    "Rt": "Ruth",
    "1S": "1 Samuel",
    "2S": "2 Samuel",
    "1R": "1 Rois",
    "2R": "2 Rois",
    "1Ch": "1 Chroniques",
    "2Ch": "2 Chroniques",
    "Esd": "Esdras",
    "Neh": "N√©h√©mie",
    "Est": "Esther",
    "Jb": "Job",
    "Ps": "Psaumes",
    "Pr": "Proverbes",
    "Ec": "Eccl√©siaste",
    "Ct": "Cantique des Cantiques",
    "Es": "√âsa√Øe",
    "Jr": "J√©r√©mie",
    "Lm": "Lamentations",
    "Ez": "√âz√©chiel",
    "Dn": "Daniel",
    "Os": "Os√©e",
    "Jl": "Jo√´l",
    "Am": "Amos",
    "Ab": "Abdias",
    "Jon": "Jonas",
    "Mi": "Mich√©e",
    "Na": "Nahum",
    "Ha": "Habacuc",
    "So": "Sophonie",
    "Ag": "Agg√©e",
    "Za": "Zacharie",
    "Ml": "Malachie",
    "Mt": "Matthieu",
    "Mc": "Marc",
    "Lc": "Luc",
    "Jn": "Jean",
    "Ac": "Actes",
    "Rm": "Romains",
    "1Co": "1 Corinthiens",
    "2Co": "2 Corinthiens",
    "Ga": "Galates",
    "Ep": "√âph√©siens",
    "Ph": "Philippiens",
    "Col": "Colossiens",
    "1Th": "1 Thessaloniciens",
    "2Th": "2 Thessaloniciens",
    "1Tm": "1 Timoth√©e",
    "2Tm": "2 Timoth√©e",
    "Tt": "Tite",
    "Phm": "Phil√©mon",
    "Heb": "H√©breux",
    "Jc": "Jacques",
    "1P": "1 Pierre",
    "2P": "2 Pierre",
    "1Jn": "1 Jean",
    "2Jn": "2 Jean",
    "3Jn": "3 Jean",
    "Jud": "Jude",
    "Ap": "Apocalypse"
};

const books = [
    // üìú Pentateuque
    { name: "Gn", category: "pentateuque" }, { name: "Ex", category: "pentateuque" },
    { name: "Lv", category: "pentateuque" }, { name: "Nb", category: "pentateuque" },
    { name: "Dt", category: "pentateuque" },

    // üè∞ Livres historiques
    { name: "Jos", category: "historiques" }, { name: "Jg", category: "historiques" },
    { name: "Rt", category: "historiques" }, { name: "1S", category: "historiques" },
    { name: "2S", category: "historiques" }, { name: "1R", category: "historiques" },
    { name: "2R", category: "historiques" }, { name: "1Ch", category: "historiques" },
    { name: "2Ch", category: "historiques" }, { name: "Esd", category: "historiques" },
    { name: "Ne", category: "historiques" }, { name: "Est", category: "historiques" },

    // üé≠ Livres de Sagesse
    { name: "Job", category: "sagesse" }, { name: "Ps", category: "sagesse" },
    { name: "Pr", category: "sagesse" }, { name: "Ec", category: "sagesse" },
    { name: "Ct", category: "sagesse" },

    // üì¢ Grands Proph√®tes
    { name: "Es", category: "grands-prophetes" }, { name: "Jr", category: "grands-prophetes" },
    { name: "Lm", category: "grands-prophetes" }, { name: "Ez", category: "grands-prophetes" },
    { name: "Dn", category: "grands-prophetes" },

    // üî• Petits Proph√®tes
    { name: "Os", category: "petits-prophetes" }, { name: "Jl", category: "petits-prophetes" },
    { name: "Am", category: "petits-prophetes" }, { name: "Ab", category: "petits-prophetes" },
    { name: "Jon", category: "petits-prophetes" }, { name: "Mi", category: "petits-prophetes" },
    { name: "Na", category: "petits-prophetes" }, { name: "Ha", category: "petits-prophetes" },
    { name: "So", category: "petits-prophetes" }, { name: "Ag", category: "petits-prophetes" },
    { name: "Za", category: "petits-prophetes" }, { name: "Ml", category: "petits-prophetes" },

    // ‚úùÔ∏è √âvangiles
    { name: "Mt", category: "evangiles" }, { name: "Mc", category: "evangiles" },
    { name: "Lc", category: "evangiles" }, { name: "Jn", category: "evangiles" },

    // üèõÔ∏è Histoire de l'√âglise
    { name: "Ac", category: "histoire-eglise" },

    // üìú √âp√Ætres de Paul
    { name: "Rm", category: "epitres-paul" }, { name: "1Co", category: "epitres-paul" },
    { name: "2Co", category: "epitres-paul" }, { name: "Ga", category: "epitres-paul" },
    { name: "Ep", category: "epitres-paul" }, { name: "Ph", category: "epitres-paul" },
    { name: "Col", category: "epitres-paul" }, { name: "1Th", category: "epitres-paul" },
    { name: "2Th", category: "epitres-paul" }, { name: "1Tm", category: "epitres-paul" },
    { name: "2Tm", category: "epitres-paul" }, { name: "Tt", category: "epitres-paul" },
    { name: "Phm", category: "epitres-paul" }, { name: "He", category: "epitres-paul" },

    // ‚úâÔ∏è √âp√Ætres G√©n√©rales
    { name: "Jc", category: "epitres-generales" }, { name: "1P", category: "epitres-generales" },
    { name: "2P", category: "epitres-generales" }, { name: "1Jn", category: "epitres-generales" },
    { name: "2Jn", category: "epitres-generales" }, { name: "3Jn", category: "epitres-generales" },
    { name: "Jd", category: "epitres-generales" },

    // üîÆ Proph√©tie
    { name: "Ap", category: "proph√©tie" }
];

</script>

<script>

// R√©cup√©ration de l'√©l√©ment conteneur
let container = document.getElementById("bibleBooks");

// üîπ √âtape 1 : Afficher tous les livres (avec leurs couleurs de cat√©gorie)
let allBooksDiv = document.createElement("div");
allBooksDiv.classList.add("all-books-container");

books.forEach(book => {
    let category = categories.find(cat => cat.key === book.category); // Trouver la cat√©gorie
    let color = category ? category.color : "gray"; // Utiliser la couleur de la cat√©gorie

    let button = document.createElement("button");
    if (button.classList.contains("correct") || button.classList.contains("wrong")) {
        button.textContent = book.name;
        button.classList.add("livre");
        button.style.background = "black"; // Appliquer la couleur
    }
    else {
        button.textContent = book.name;
        button.classList.add("livre");
        button.style.background = `linear-gradient(to right, ${color}, ${color})`; // Appliquer la couleur
    }
    button.addEventListener("click", function() {
    console.log("Livre cliqu√© :", book.name); // Debugging
    console.log("Livre √† trouver :", "Job 17".replace(/\s*\d+$/, ""));
    console.log("Livre complet cliqu√© :", booksMapping[book.name]); // Debugging

    let chapter_str = "Job 17".replace(/\s*\d+$/, "");

    if (booksMapping[book.name] === chapter_str) {
        button.classList.add("correct");
        document.getElementById("message_final").textContent = "üéâ Bravo ! Vous avez trouv√© le bon livre !";
    } else {
        button.classList.add("wrong");
    }
    });

    allBooksDiv.appendChild(button);
});

container.appendChild(allBooksDiv);

// üîπ Fonction qui filtre et d√©sactive les livres "correct" et "wrong"
function filterBooks() {
        document.querySelectorAll(".livre").forEach(button => {
            if (button.classList.contains("correct") || button.classList.contains("wrong")) {
                button.disabled = true; // D√©sactive le bouton
            }
        });
    }
</script>


</body>
</html>